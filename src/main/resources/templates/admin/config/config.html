<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      th:replace="~{layout/admin :: layout(~{::content})}">
<body>
<div th:fragment="content">
    <div class="container mt-4">
        <h3 class="mb-3">üõ†Ô∏è Qu·∫£n l√Ω B·∫£o Tr√¨ H·ªá Th·ªëng</h3>

        <!-- Th√¥ng b√°o -->
        <div th:if="${message}" class="alert alert-success alert-dismissible fade show" role="alert">
            <span th:text="${message}"></span>
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
        <div th:if="${error}" class="alert alert-danger alert-dismissible fade show" role="alert">
            <span th:text="${error}"></span>
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
		<div class="card mb-4">
		    <div class="card-header">
		        <h5>Th√¥ng tin li√™n h·ªá</h5>
		    </div>
		    <div class="card-body">
		        <form th:action="@{/admin/system-config/update-info}" method="post">
		            <div class="mb-3">
		                <label for="mail" class="form-label">Email</label>
		                <input type="text" class="form-control" id="mail" name="mail"
		                       th:value="${infoConfig.mail}">
		            </div>
		            <div class="mb-3">
		                <label for="phone" class="form-label">S·ªë ƒëi·ªán tho·∫°i</label>
		                <input type="text" class="form-control" id="phone" name="phone"
		                       th:value="${infoConfig.phone}">
		            </div>
		            <button type="submit" class="btn btn-primary">C·∫≠p nh·∫≠t</button>
		        </form>
		    </div>
		</div>
        <!-- Form th√™m -->
        <div class="card mb-4">
            <div class="card-header">Th√™m Th·ªùi Gian B·∫£o Tr√¨</div>
            <div class="card-body">
                <form th:action="@{/admin/system-config/add}" method="post">
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <label for="start" class="form-label">Th·ªùi gian b·∫Øt ƒë·∫ßu</label>
                            <input type="datetime-local" class="form-control" id="start" name="start" required>
                        </div>
                        <div class="col-md-6">
                            <label for="end" class="form-label">Th·ªùi gian k·∫øt th√∫c</label>
                            <input type="datetime-local" class="form-control" id="end" name="end" required>
                        </div>
                    </div>
                    <button type="submit" class="btn btn-primary">Th√™m</button>
                </form>
            </div>
        </div>

        <!-- Danh s√°ch -->
        <div class="card">
            <div class="card-header">Danh S√°ch Th·ªùi Gian B·∫£o Tr√¨</div>
            <div class="card-body">
                <table class="table table-bordered table-hover align-middle">
                    <thead class="table-light">
                        <tr>
                            <th>ID</th>
                            <th>H√†nh ƒë·ªông</th>
                            <th>Th·ªùi gian b·∫Øt ƒë·∫ßu</th>
                            <th>Th·ªùi gian k·∫øt th√∫c</th>
                            <th>Ng∆∞·ªùi th·ª±c hi·ªán</th>
                            <th>Thao t√°c</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr th:each="log : ${list}">
                            <td th:text="${log.id}"></td>
                            <td th:text="${log.action}"></td>
                            <td th:text="${log.createdAt != null ? #temporals.format(log.createdAt, 'yyyy-MM-dd HH:mm') : 'N/A'}"></td>
                            <td th:text="${log.endDateTime != null ? #temporals.format(log.endDateTime, 'yyyy-MM-dd HH:mm') : 'N/A'}"></td>
                            <td th:text="${log.account != null ? log.account.username : 'N/A'}"></td>
                            <td>
                                <!-- N√∫t ch·ªânh s·ª≠a -->
                                <button type="button" class="btn btn-sm btn-warning" data-bs-toggle="modal"
                                        th:attr="data-bs-target='#editModal' + ${log.id}">
                                    S·ª≠a
                                </button>
                                <!-- N√∫t x√≥a -->
                                <a th:href="@{/admin/system-config/delete/{id}(id=${log.id})}"
                                   class="btn btn-sm btn-danger"
                                   onclick="return confirm('B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a b·∫£n ghi n√†y?')">X√≥a</a>
                            </td>
                        </tr>
                        <tr th:if="${#lists.isEmpty(list)}">
                            <td colspan="6" class="text-center text-muted">Ch∆∞a c√≥ th·ªùi gian b·∫£o tr√¨ n√†o</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Modal ch·ªânh s·ª≠a -->
        <div th:each="log : ${list}" class="modal fade" th:id="'editModal' + ${log.id}" tabindex="-1"
             aria-labelledby="editModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="editModalLabel">Ch·ªânh s·ª≠a Th·ªùi Gian B·∫£o Tr√¨</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <form th:action="@{/admin/system-config/update}" method="post">
                            <input type="hidden" name="id" th:value="${log.id}">
                            <div class="mb-3">
                                <label class="form-label">Th·ªùi gian b·∫Øt ƒë·∫ßu</label>
                                <input type="datetime-local" class="form-control" name="start"
                                       th:value="${log.createdAt != null ? #temporals.format(log.createdAt, 'yyyy-MM-dd''T''HH:mm') : ''}"
                                       required>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Th·ªùi gian k·∫øt th√∫c</label>
                                <input type="datetime-local" class="form-control" name="end"
                                       th:value="${log.endDateTime != null ? #temporals.format(log.endDateTime, 'yyyy-MM-dd''T''HH:mm') : ''}"
                                       required>
                            </div>
                            <button type="submit" class="btn btn-primary">L∆∞u thay ƒë·ªïi</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
		
    </div> <!-- container -->
</div>
</body>
</html>