<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	th:replace="~{layout/admin :: layout(~{::content})}">
<head>
<meta charset="UTF-8">
<title>Test Payment</title>
</head>
<body>
	<div th:fragment="content">
		<!-- Header with Create Order Button -->
		<div class="d-flex justify-content-between align-items-center mb-4">
			<h1 class="text-primary">
				<i class="fas fa-credit-card me-2"></i> Payment System
			</h1>

		</div>

		<!-- Alert Messages -->
		<div th:if="${successMessage}"
			class="alert alert-success alert-dismissible fade show">
			<i class="fas fa-check-circle me-2"></i> <span
				th:text="${successMessage}"></span>
			<button type="button" class="btn-close" data-bs-dismiss="alert"></button>
		</div>
		<div th:if="${errorMessage}"
			class="alert alert-danger alert-dismissible fade show">
			<i class="fas fa-exclamation-circle me-2"></i> <span
				th:text="${errorMessage}"></span>
			<button type="button" class="btn-close" data-bs-dismiss="alert"></button>
		</div>

		<!-- Orders Section -->
		<div class="card mb-4">
			<div class="card-header bg-primary text-white">
				<h1 class="h4 mb-0">
					<i class="fas fa-shopping-cart me-2"></i>Danh sách đơn hàng
				</h1>
			</div>
			<div class="card-body">
				<div class="table-responsive">
					<table class="table table-striped table-hover">
						<thead class="table-dark">
							<tr>
								<th>ID</th>
								<th>Mã đơn hàng</th>
								<th>Tổng tiền</th>
								<th>Trạng thái</th>
								<th>Khách hàng</th>
								<th>Ngày tạo</th>
								<th>Thao tác</th>
							</tr>
						</thead>
						<tbody>
							<tr th:each="order : ${orders}">
								<td th:text="${order.id}"></td>
								<td><code th:text="${order.orderCode}"></code></td>
								<td><span class="text-success fw-bold"
									th:text="${#numbers.formatCurrency(order.totalAmount)}"></span>
								</td>
								<td><span class="badge"
									th:classappend="${order.status.name() == 'PENDING'} ? 'bg-warning' : 
                                                        (${order.status.name() == 'PROCESSING'} ? 'bg-info' : 
                                                        (${order.status.name() == 'DELIVERED'} ? 'bg-success' : 'bg-secondary'))"
									th:text="${order.status}"></span></td>
								<td th:text="${order.customer.lastName}"></td>
								<td
									th:text="${#temporals.format(order.createdAt, 'dd/MM/yyyy HH:mm')}"></td>
								<td><a
									th:href="@{'/admin/test-order-detail/' + ${order.id}}"
									class="btn btn-sm btn-outline-primary"> <i
										class="fas fa-eye me-1"></i>Chi tiết
								</a></td>
							</tr>
							<tr th:if="${#lists.isEmpty(orders)}">
								<td colspan="7" class="text-center text-muted"><i
									class="fas fa-inbox fa-2x mb-2"></i><br> Chưa có đơn hàng
									nào.
							</tr>
						</tbody>
					</table>
				</div>
			</div>
		</div>


		<div class="card mb-4">
			<div class="card-header bg-success text-white">
				<h1 class="h4 mb-0">
					<i class="fas fa-calendar-check me-2"></i>Danh sách Booking
				</h1>
			</div>
			<div class="card-body">
				<div class="table-responsive">
					<table class="table table-striped table-hover">
						<thead class="table-dark">
							<tr>
								<th>ID</th>
								<th>Mã Booking</th>
								<th>Khách hàng</th>
								<th>Sân</th>
								<th>Giờ bắt đầu</th>
								<th>Giờ kết thúc</th>
								<th>Số giờ</th>
								<th>Tổng tiền</th>
								<th>Trạng thái</th>
								<th>Ngày tạo</th>
							</tr>
						</thead>
						<tbody>
							<tr th:each="booking : ${bookings}">
								<td th:text="${booking.id}"></td>
								<td><code th:text="${booking.bookingCode}"></code></td>
								<td
									th:text="${booking.customer != null ? booking.customer.lastName : 'N/A'}"></td>
								<td
									th:text="${booking.field != null ? booking.field.name : 'N/A'}"></td>
								<td
									th:text="${#temporals.format(booking.startTime, 'dd/MM/yyyy HH:mm')}"></td>
								<td
									th:text="${#temporals.format(booking.endTime, 'dd/MM/yyyy HH:mm')}"></td>
								<td th:text="${booking.durationInHours} + ' giờ'"></td>
								<td><span class="text-success fw-bold"
									th:text="${#numbers.formatCurrency(booking.totalAmount)}"></span>
								</td>
								<td><span class="badge"
									th:classappend="${booking.status.name() == 'CONFIRMED'} ? 'bg-success' :
                                                  (${booking.status.name() == 'PENDING'} ? 'bg-warning' :
                                                  (${booking.status.name() == 'CANCELLED'} ? 'bg-danger' :
                                                  (${booking.status.name() == 'COMPLETED'} ? 'bg-primary' : 'bg-secondary')))"
									th:text="${booking.status}"></span></td>
								<td
									th:text="${#temporals.format(booking.createdAt, 'dd/MM/yyyy HH:mm')}"></td>
							</tr>

							<tr th:if="${#lists.isEmpty(bookings)}">
								<td colspan="10" class="text-center text-muted"><i
									class="fas fa-info-circle fa-2x mb-2"></i><br> Chưa có
									booking nào.</td>
							</tr>
						</tbody>
					</table>
				</div>
			</div>
		</div>


		<!-- Payments Section -->
		<div class="card mb-4">
			<div class="card-header bg-success text-white">
				<h1 class="h4 mb-0">
					<i class="fas fa-money-bill-wave me-2"></i>Danh sách thanh toán
				</h1>
			</div>
			<div class="card-body">
				<div class="table-responsive">
					<table class="table table-striped table-hover">
						<thead class="table-dark">
							<tr>
								<th>ID</th>
								<th>Mã thanh toán</th>
								<th>Số tiền</th>
								<th>Phương thức</th>
								<th>Trạng thái</th>
								<th>Ngày thanh toán</th>
								<th>Đơn hàng</th>
							</tr>
						</thead>
						<tbody>
							<tr th:each="payment : ${payments}">
								<td th:text="${payment.id}"></td>
								<td><code th:text="${payment.paymentCode}"></code></td>
								<td><span class="text-success fw-bold"
									th:text="${#numbers.formatCurrency(payment.amount)}"></span></td>
								<td><span class="badge bg-info"
									th:text="${payment.paymentMethod}"></span></td>
								<td><span class="badge"
									th:classappend="${payment.status.name() == 'COMPLETED'} ? 'bg-success' : 
                                                        (${payment.status.name() == 'PENDING'} ? 'bg-warning' : 
                                                        (${payment.status.name() == 'FAILED'} ? 'bg-danger' : 'bg-secondary'))"
									th:text="${payment.status}"></span></td>
								<td
									th:text="${payment.paidAt != null} ? ${#temporals.format(payment.paidAt, 'dd/MM/yyyy HH:mm')} : 'Chưa thanh toán'"></td>
								<td><a th:if="${payment.order}"
									th:href="@{'/admin/test-order-detail/' + ${payment.order.id}}"
									class="btn btn-sm btn-outline-primary"> <i
										class="fas fa-external-link-alt me-1"></i> <span
										th:text="${payment.order.orderCode}"></span>
								</a></td>
							</tr>
							<tr th:if="${#lists.isEmpty(payments)}">
								<td colspan="7" class="text-center text-muted"><i
									class="fas fa-wallet fa-2x mb-2"></i><br> Chưa có thanh
									toán nào.</td>
							</tr>
						</tbody>
					</table>
				</div>
			</div>
		</div>
	</div>
</body>
</html>