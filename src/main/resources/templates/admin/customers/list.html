<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" th:replace="~{layout/admin :: layout(~{::content})}">
<body>
<div th:fragment="content">
    <h2 class="mb-3">üë• Qu·∫£n l√Ω kh√°ch h√†ng</h2>

    <!-- Th√¥ng b√°o -->
    <div th:if="${successMessage}" class="alert alert-success" th:text="${successMessage}"></div>
    <div th:if="${errorMessage}" class="alert alert-danger" th:text="${errorMessage}"></div>

    <!-- Th·ªëng k√™ -->
    <div class="card mb-3">
        <div class="card-body">
            <h5 class="card-title">üìä Th·ªëng k√™</h5>
            <p class="card-text">T·ªïng s·ªë kh√°ch h√†ng: <strong th:text="${totalElements}">0</strong></p>
        </div>
    </div>

    <table class="table table-striped table-hover">
        <thead class="table-dark">
        <tr>
            <th>ID</th>
            <th>H·ªç v√† t√™n</th>
            <th>S·ªë ƒëi·ªán tho·∫°i</th>
            <th>Ng√†y sinh</th>
            <th>Gi·ªõi t√≠nh</th>
            <th>ƒê·ªãa ch·ªâ</th>
            <th>Ng√†y t·∫°o</th>
            <th>H√†nh ƒë·ªông</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="customer : ${customers.content}">
            <td th:text="${customer.id}"></td>
            <td th:text="${customer.fullName}"></td>
            <td th:text="${customer.phoneNumber ?: 'Ch∆∞a c√≥'}"></td>
            <td th:text="${customer.dateOfBirth != null ? #temporals.format(customer.dateOfBirth, 'dd/MM/yyyy') : 'Ch∆∞a c√≥'}"></td>
            <td>
                <span th:if="${customer.gender == T(utescore.entity.Customer.Gender).MALE}" class="badge bg-primary">Nam</span>
                <span th:if="${customer.gender == T(utescore.entity.Customer.Gender).FEMALE}" class="badge bg-info">N·ªØ</span>
                <span th:if="${customer.gender == T(utescore.entity.Customer.Gender).OTHER}" class="badge bg-secondary">Kh√°c</span>
                <span th:if="${customer.gender == null}" class="badge bg-light text-dark">Ch∆∞a c√≥</span>
            </td>
            <td th:text="${customer.address ?: 'Ch∆∞a c√≥'}" style="max-width: 150px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;"></td>
            <td th:text="${#temporals.format(customer.createdAt, 'dd/MM/yyyy HH:mm')}"></td>
            <td>
                <a th:href="@{'/admin/customers/' + ${customer.id}}" class="btn btn-info btn-sm" title="Xem chi ti·∫øt">üëÅÔ∏è</a>
                <a th:href="@{'/admin/customers/' + ${customer.id} + '/edit'}" class="btn btn-warning btn-sm" title="Ch·ªânh s·ª≠a">‚úèÔ∏è</a>
                <form th:action="@{'/admin/customers/' + ${customer.id} + '/delete'}" method="post" class="d-inline">
                    <button type="submit" class="btn btn-danger btn-sm" title="X√≥a"
                            onclick="return confirm('X√°c nh·∫≠n x√≥a kh√°ch h√†ng n√†y? Thao t√°c n√†y kh√¥ng th·ªÉ ho√†n t√°c!')">üóëÔ∏è</button>
                </form>
            </td>
        </tr>
        <tr th:if="${customers.empty}">
            <td colspan="8" class="text-center text-muted">Kh√¥ng c√≥ kh√°ch h√†ng n√†o</td>
        </tr>
        </tbody>
    </table>

    <!-- Ph√¢n trang -->
    <nav th:if="${totalPages > 1}">
        <ul class="pagination justify-content-center">
            <li class="page-item" th:classappend="${currentPage == 0} ? 'disabled'">
                <a class="page-link" th:href="@{/admin/customers(page=${currentPage - 1})}" 
                   th:if="${currentPage > 0}">‚Äπ Tr∆∞·ªõc</a>
                <span class="page-link" th:if="${currentPage == 0}">‚Äπ Tr∆∞·ªõc</span>
            </li>
            
            <li class="page-item" th:each="i : ${#numbers.sequence(0, totalPages - 1)}"
                th:classappend="${i == currentPage} ? 'active'">
                <a class="page-link"
                   th:href="@{/admin/customers(page=${i})}"
                   th:text="${i + 1}"></a>
            </li>
            
            <li class="page-item" th:classappend="${currentPage == totalPages - 1} ? 'disabled'">
                <a class="page-link" th:href="@{/admin/customers(page=${currentPage + 1})}" 
                   th:if="${currentPage < totalPages - 1}">Sau ‚Ä∫</a>
                <span class="page-link" th:if="${currentPage == totalPages - 1}">Sau ‚Ä∫</span>
            </li>
        </ul>
    </nav>
</div>
</body>
</html>